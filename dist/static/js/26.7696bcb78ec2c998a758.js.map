{"version":3,"sources":["webpack:///src/components/heatmapsvg.vue","webpack:///./src/components/heatmapsvg.vue?26a9","webpack:///./src/components/heatmapsvg.vue"],"names":["heatmapsvg","data","arr","temp","value","sortValue","idShow","visible","height","components","leftMenu","degComp","imgMenuShowComp","[object Object]","this","$store","state","heatmapJson","heatmap_json_string","JSON","parse","self","k","nodes","node","preOrder","distance","push","objects","i","features","length","d3heatmap","watch","$route","methods","idShowChange","d3","remove","yData","xData","feature_names","tooltip","append","style","text","margin","width","gridSize","Math","floor","sort","a","b","min","ceil","middle","max","linear","domain","range","darker","svg","attr","selectAll","enter","d","parseInt","on","event","pageY","pageX","transition","duration","$router","name","components_heatmapsvg","render","_vm","_h","$createElement","_c","_self","staticStyle","margin-top","directives","rawName","expression","border-right","attrs","_v","staticClass","active-text","inactive-text","change","model","callback","$$v","id","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/26.7696bcb78ec2c998a758.js","sourcesContent":["<template>\n  <el-container style=\"height:calc(100% - 62px);margin-top:2px\">\n    <el-aside v-show=\"$store.state.menuShow\" width=\"350px;\" style=\"width:300px;height:100%;border-right:1px solid #e6e6e6\">\n      <leftMenu style=\"margin-top:5px\"></leftMenu>\n    </el-aside>\n    <el-main>\n      <imgMenuShowComp></imgMenuShowComp>\n\n      <degComp></degComp>\n\n      <div class=\"\">\n        <div class=\"icon-func-div\">\n          <span class=\"font-size-12\">ID显示</span>\n          <el-switch\n            v-model=\"idShow\"\n            active-text=\"\"\n            inactive-text=\"\"\n            @change=\"idShowChange\"\n            >\n          </el-switch>\n        </div>\n\n        <div id=\"chart\"></div>\n\n        </div>\n    </el-main>\n  </el-container>\n</template>\n\n<script>\nimport leftMenu from './leftMenu.vue'\nimport degComp from './degComp.vue'\nimport imgMenuShowComp from './imgMenuShowComp.vue'\n\nimport * as d3 from 'd3'\n\nimport Highcharts from 'highcharts/highstock';\nexport default {\n  data () {\n    return {\n      arr: [],\n      temp: [],\n      value: [],\n      sortValue: [],\n      idShow: false,\n      visible: 'hidden',\n      height: 5,\n    }\n  },\n  components: {\n    leftMenu,\n    degComp,\n    imgMenuShowComp\n  },\n  created () {\n    this.$store.state.heatmapJson.heatmap_json_string = JSON.parse(this.$store.state.heatmapJson.heatmap_json_string)\n\n    let self = this\n    for (let k in this.$store.state.heatmapJson.heatmap_json_string.data.nodes) {\n      let node = this.$store.state.heatmapJson.heatmap_json_string.data.nodes[k]\n      if (('parent' in node) === false) {\n        preOrder(node)\n      }\n    }\n    function preOrder(node){\n       if(node.distance === 0){\n         self.temp.push(node.objects[0]);  // y 轴的gene名称\n         for(let i = 0;i < node.features.length;i++) {\n           self.value.push(node.features[i])   // 每一行的值\n           self.sortValue.push(node.features[i])  // 用来排序的数组\n         }\n       } else {\n         preOrder(self.$store.state.heatmapJson.heatmap_json_string.data.nodes[node['left_child']]);\n         preOrder(self.$store.state.heatmapJson.heatmap_json_string.data.nodes[node['right_child']]);\n       }\n     }\n  },\n  mounted () {\n    this.d3heatmap()\n  },\n  watch: {\n    '$route': 'routerChange'\n  },\n  methods: {\n    routerChange () {\n      this.idShow = false\n      this.idShowChange()\n    },\n    idShowChange () {\n      if (this.idShow === true) {\n        this.height = 9\n        this.visible = 'visible'\n      } else {\n        this.height = 5\n        this.visible = 'hidden'\n      }\n      this.d3heatmap()\n    },\n    d3heatmap () {\n      let hassvg = d3.selectAll('.d3svg')\n      if (hassvg) {\n        d3.selectAll('.d3svg').remove()\n      }\n      let self = this\n      let yData = self.temp\n      let xData = this.$store.state.heatmapJson.heatmap_json_string.data.feature_names\n      // mouseover text\n      let tooltip = d3.select('body')\n        .append('div')\n        .style('position', 'absolute')\n        .style('z-index', '10')\n        .style('visibility', 'hidden')\n        .style('font-size', '14px')\n        .style('font-weight', 'bold')\n        .style('color', 'yellow')\n        .text('')\n      var array_data = [];\n      var margin = { top: 50, right: 20, bottom: 100, left: 100 },\n          width = 820 - margin.left - margin.right,        // 所有格子区域的宽度，即Heatmap的宽度\n          height = self.height * yData.length ,\n          gridSize = Math.floor(width / xData.length)     // 求地板，即去掉小数部分，width分成 xData.length 份\n\n              function sortNumber (a, b) {\n                return a - b\n              }\n              self.sortValue.sort(sortNumber)   //  排序后的数组\n              let min = self.sortValue[Math.ceil(0.1 * self.sortValue.length)]\n              let middle = self.sortValue[Math.ceil(self.sortValue.length/2)]\n              let max = self.sortValue[self.sortValue.length - Math.ceil(0.1 * self.sortValue.length) - 1]\n\n              var linear = d3.scaleLinear()\n              \t\t\t\t.domain([min, middle, max])\n              \t\t\t\t.range([(d3.rgb(0,255,0)).darker(1), (d3.rgb(19,3,3)).darker(1), (d3.rgb(255,0,0)).darker(0.7)]);\n\n              // 设置chart，svg\n              var svg = d3.select(\"#chart\").append(\"svg\") // 选择“chart”（就是div），加入一个svg，设置属性跟div一样大\n                  .attr(\"width\", width + margin.left + margin.right)\n                  .attr(\"height\", height + margin.top + margin.bottom)\n                  .attr(\"class\", \"d3svg\")\n                  .append(\"g\")    // 在svg内加入一个g（group组），并设置元素g的显示位置\n                  .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\")\n\n              var timeLabels = svg.selectAll(\".testLabel\")\n                  .data(xData)\n                  .enter().append(\"text\")\n                  .text(function(d) { return d; })\n                  .attr(\"x\", function(d, i) { return i * gridSize + 15; })\n                  .attr(\"y\", height)\n                  .attr(\"class\", 'xText')\n                  .style(\"font-size\", \"9px\")\n                  // .style(\"font-weight\", \"bold\")\n                  .style(\"font-family\", \"Consolas, Monaco, monospace\")\n                  .style(\"text-anchor\", \"start\")\n                  .attr('transform', (d,i)=>{\n                    return 'rotate(45, ' + (i * gridSize) + ' '+ (height) +')'\n                  })\n\n             var dayLabels = svg.selectAll(\".nameLabel\")\n                 .data(yData)\n                 .enter()    // 为data中每一项创建一个\".dayLabel\"\n                 .append(\"text\")    // 为days中每一项创建一的\".dayLabel\"添加文本，下面全是设置文本的属性\n                 .text(function (d) { return d; })\n                 .attr(\"x\", 0)\n                 .attr(\"y\", function (d, i) { return i * 9; })\n                 .style(\"text-anchor\", \"end\")\n                 .style(\"font-size\", \"9px\")\n                 .style(\"font-family\", \"Consolas, Monaco, monospace\")\n                 .attr(\"transform\", \"translate(-6,\" + \"9)\")\n                 .attr('class', 'ySum')\n                 .style('visibility', self.visible)\n              var heatMap = svg.selectAll(\".score\")\n                  .data(self.value)\n                  .enter()\n                  .append(\"rect\")\n                  .attr(\"x\", function(d, i){ return (i % xData.length)*gridSize;})\n                  .attr(\"y\", function(d, i){ return parseInt(i / xData.length) * self.height;})\n                  .attr(\"width\", gridSize)\n                  .attr(\"height\", self.height)\n                  .style(\"fill\", \"#FFFFFF\")\n                  .on('mouseover', function (d, i) {\n                    return tooltip.style('visibility', 'visible').text(d)\n                  })\n                  .on('mousemove', function (d, i) {\n                    return tooltip.style('top', (event.pageY-10)+'px').style('left',(event.pageX+10)+'px')\n                  })\n                  .on('mouseout', function (d, i) {\n                    return tooltip.style('visibility', 'hidden')\n                  })\n              // duration(1000) 在1000ns也就是1s内将格子图上色\n              heatMap.transition().duration(500)\n                  .style(\"fill\", function(d) { return linear(d) });\n    },\n    backHeatmapsvgInput () {\n      this.$router.push({'name': 'heatmapsvg_input'})\n    },\n  }\n}\n</script>\n\n<style scoped=\"true\">\n.content {\n  float:left;\n  width: 60%;\n  padding: 0 20px;\n  margin: 19px auto;\n}\n.icon-func-div {\n  margin-top: 10px;\n}\n.font-size-12 {\n  font-size: 12px;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/heatmapsvg.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-container',{staticStyle:{\"height\":\"calc(100% - 62px)\",\"margin-top\":\"2px\"}},[_c('el-aside',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.$store.state.menuShow),expression:\"$store.state.menuShow\"}],staticStyle:{\"width\":\"300px\",\"height\":\"100%\",\"border-right\":\"1px solid #e6e6e6\"},attrs:{\"width\":\"350px;\"}},[_c('leftMenu',{staticStyle:{\"margin-top\":\"5px\"}})],1),_vm._v(\" \"),_c('el-main',[_c('imgMenuShowComp'),_vm._v(\" \"),_c('degComp'),_vm._v(\" \"),_c('div',{},[_c('div',{staticClass:\"icon-func-div\"},[_c('span',{staticClass:\"font-size-12\"},[_vm._v(\"ID显示\")]),_vm._v(\" \"),_c('el-switch',{attrs:{\"active-text\":\"\",\"inactive-text\":\"\"},on:{\"change\":_vm.idShowChange},model:{value:(_vm.idShow),callback:function ($$v) {_vm.idShow=$$v},expression:\"idShow\"}})],1),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"chart\"}})])],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-24cb9384\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/heatmapsvg.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-24cb9384\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./heatmapsvg.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./heatmapsvg.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./heatmapsvg.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-24cb9384\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./heatmapsvg.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-24cb9384\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/heatmapsvg.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}