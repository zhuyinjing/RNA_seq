webpackJsonp([18],{"5NRR":function(e,t){},"6+F8":function(e,t){},uBDn:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("Oj91"),r=n("SH1Y"),s=n("K0Oa"),o=n("f4AQ"),a={data:()=>({originNodes:null,singleNodes:null,graph:{},singleGeneShow:!1}),components:{leftMenu:i.a,degComp:r.a,imgMenuShowComp:s.a},mounted(){this.getValue()},methods:{getValue(){this.axios.get("/server/deg_effect_of_force_diagram?username="+this.$store.state.username+"&p="+this.$store.state.projectId+"&caseSample="+this.$store.state._case+"&controlSample="+this.$store.state._control).then(e=>{"success"===e.data.message_type?(this.originNodes=e.data.message.relevanceGeneNodes,this.singleNodes=e.data.message.discreteGeneNodes,this.graph={nodes:e.data.message.relevanceGeneNodes,links:e.data.message.scoreMatrixList},this.initD3()):this.$message.error(e.data.message)})},singleGeneShowChange(){o.selectAll("g")&&o.selectAll("svg").remove(),!0===this.singleGeneShow?this.graph.nodes=this.graph.nodes.concat(this.singleNodes):this.graph.nodes=this.originNodes,setTimeout(()=>{this.initD3()},50)},initD3(){document.getElementById("d3container").clientWidth;let e=o.select("#d3container").append("svg").attr("id","svg").attr("width",1200).attr("height",960);var t,n,i,r,s,a=+e.attr("width"),l=+e.attr("height");o.scaleOrdinal(o.schemeCategory20);if(!1===this.singleGeneShow)var c=o.forceSimulation().force("link",o.forceLink().id(function(e){return e.id})).force("charge",o.forceManyBody().strength(-300).distanceMax(300)).force("center",o.forceCenter(a/2,l/2));else c=o.forceSimulation().force("link",o.forceLink().id(function(e){return e.id})).force("charge",o.forceManyBody().strength(-200).distanceMax(100)).force("center",o.forceCenter(a/2,l/2));o.select("body").on("keydown",function(){var e=o.event.metaKey,t=68===o.event.keyCode;e&&s.attr("pointer-events","none");t&&(n.classed("picked",!1),n.each(function(e){e.picked=e.previouslyPicked=!1}))}).on("keyup",function(){o.event.metaKey||s.attr("pointer-events","all")}),r=o.brush().extent([[0,0],[a,l]]).on("start",function(e){n.each(function(e){e.previouslyPicked=void 0})}).on("brush",function(){if(o.event.selection){var e=o.event.selection,t=o.zoomTransform(s.node());n.classed("picked",function(n){return n.picked=n.previouslyPicked^((e[0][0]-t.x)/t.k<=n.x&&n.x<(e[1][0]-t.x)/t.k&&(e[0][1]-t.y)/t.k<=n.y&&n.y<(e[1][1]-t.y)/t.k)})}}).on("end",function(){o.event.selection&&o.select(this).call(o.event.target.move,null)});var d=o.zoom().scaleExtent([.5,4]).on("zoom",function(){t.attr("transform",o.event.transform)});e.append("g").attr("id","brush-layer").attr("width",a).attr("height",l).style("fill","none").datum(function(){return{picked:!1,previouslyPicked:!1}}).call(r).on("click",function(e){n.classed("picked",!1),n.each(function(e){e.picked=e.previouslyPicked=!1})}),s=e.append("rect").attr("id","zoom-layer").attr("width",a).attr("height",l).style("fill","none").attr("pointer-events","all").call(d),t=e.append("g");let u=this.graph;var f=o.scaleLinear().range([1,5]).domain(o.extent(u.links.map((e,t)=>e.value)));i=t.append("g").attr("class","links").selectAll("line").data(u.links).enter().append("line").attr("stroke-width",function(e){return f(e.value)}),n=t.append("g").attr("class","nodes").selectAll("circle").data(u.nodes).enter().append("circle").attr("r",(e,t)=>20).attr("fill","#e49433").on("click",function(){o.select(this)}).on("mouseover",function(e,t,n){let i=e.id;var r=u.links.filter(t=>t.source.id==e.id||t.target.id==e.id).map(t=>t.source.id==e.id?t.target.id:t.source.id);o.select(".nodes").selectAll("circle").attr("fill",function(t){return r.indexOf(t.id)>-1||t.id==e.id?"red":"#e49433"}),o.select(".links").selectAll("line").style("stroke",function(e,t){return e.target.id===i&&r.indexOf(e.source.id)>-1||e.source.id===i&&r.indexOf(e.target.id)>-1?"red":"#999"})}).on("mouseout",function(e){o.select(".nodes").selectAll("circle").attr("fill","#e49433"),o.select(".links").selectAll("line").style("stroke","#999")}).call(o.drag().on("start",g).on("drag",p).on("end",m));let h=t.selectAll(".texts").attr("class","texts").data(u.nodes).enter().append("text").text((e,t)=>e.id).style("font-size","8px").attr("dy",".35em").attr("text-anchor","middle").on("mouseover",function(e,t,n){let i=e.id;var r=u.links.filter(t=>t.source.id==e.id||t.target.id==e.id).map(t=>t.source.id==e.id?t.target.id:t.source.id);o.select(".nodes").selectAll("circle").attr("fill",function(t){return r.indexOf(t.id)>-1||t.id==e.id?"red":"#e49433"}),o.select(".links").selectAll("line").style("stroke",function(e,t){return e.target.id===i&&r.indexOf(e.source.id)>-1||e.source.id===i&&r.indexOf(e.target.id)>-1?"red":"#999"})}).on("mouseout",function(e){o.select(".nodes").selectAll("circle").attr("fill","#e49433"),o.select(".links").selectAll("line").style("stroke","#999")}).call(o.drag().on("start",g).on("drag",p).on("end",m));function g(e){o.event.active||c.alphaTarget(.3).restart(),e.fx=e.x,e.fy=e.y}function p(e){e.fx=o.event.x,e.fy=o.event.y}function m(e){o.event.active||c.alphaTarget(0),e.fx=null,e.fy=null}c.nodes(u.nodes).on("tick",function(){i.attr("x1",function(e){return e.source.x}).attr("y1",function(e){return e.source.y}).attr("x2",function(e){return e.target.x}).attr("y2",function(e){return e.target.y}),n.attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}),h.attr("transform",e=>"translate("+e.x+","+e.y+")")}),c.force("link").links(u.links),o.selectAll(".links").selectAll("line").style("stroke","#999").style("stroke-opacity",.6)}}},l={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",{staticStyle:{height:"calc(100% - 62px)","margin-top":"2px"}},[n("el-aside",{directives:[{name:"show",rawName:"v-show",value:e.$store.state.menuShow,expression:"$store.state.menuShow"}],staticStyle:{width:"300px",height:"100%","border-right":"1px solid #e6e6e6"},attrs:{width:"350px;"}},[n("leftMenu",{staticStyle:{"margin-top":"5px"}})],1),e._v(" "),n("el-main",[n("imgMenuShowComp"),e._v(" "),n("degComp"),e._v(" "),n("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-document"},on:{click:function(t){e.$store.commit("d3savePDF","蛋白互作网络图")}}},[e._v("生成 PDF")]),e._v(" "),n("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-picture"},on:{click:function(t){e.$store.commit("d3saveSVG","蛋白互作网络图")}}},[e._v("生成 SVG")]),e._v(" "),n("br"),n("br"),e._v("\n    是否显示离散的基因：\n    "),n("el-switch",{attrs:{"active-color":"#409EFF","active-text":"显示","inactive-text":"隐藏"},on:{change:function(t){e.singleGeneShowChange()}},model:{value:e.singleGeneShow,callback:function(t){e.singleGeneShow=t},expression:"singleGeneShow"}}),e._v(" "),n("div",{attrs:{id:"d3container"}})],1)],1)},staticRenderFns:[]};var c=n("VU/8")(a,l,!1,function(e){n("5NRR"),n("6+F8")},"data-v-112464d5",null);t.default=c.exports}});
//# sourceMappingURL=18.f2ff787d5dddd8bf8822.js.map