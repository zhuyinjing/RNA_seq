webpackJsonp([10],{"/cFl":function(t,e){},uCz3:function(t,e){},xDHS:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Oj91"),i=a("K0Oa"),r=a("f4AQ"),c={data:()=>({checkboxValue:[],checkAll:!1,checkedPCA:[],isIndeterminate:!1,tableValue:[],conditionArr:[],maxValue:[],minValue:[],nameSampleMap:{},percentVariance:[],radius:6,opacity:.7}),components:{leftMenu:n.a,imgMenuShowComp:i.a},created(){this.getValue()},mounted(){},methods:{getValue(){this.axios.get("/server/pca4gene?username="+this.$store.state.username+"&p="+this.$store.state.projectId).then(t=>{this.maxValue=t.data.maxValue,this.minValue=t.data.minValue,this.percentVariance=t.data.pca4GeneExprMatrix.percentVariance,this.nameSampleMap=t.data.experimentDesign.nameSampleMap;for(let e=0;e<t.data.pca4GeneExprMatrix.percentVariance.length;e++)this.checkboxValue.push(e+1);this.checkedPCA=[this.checkboxValue[0],this.checkboxValue[1]];for(let e in t.data.experimentDesign.conditionNumMap)this.conditionArr.push(e);for(let e in t.data.pca4GeneExprMatrix.sampleCoordMap){let a={name:e,value:t.data.pca4GeneExprMatrix.sampleCoordMap[e]};this.tableValue.push(a)}this.initD3()})},handleCheckAllChange(t){this.checkedPCA=t?this.checkboxValue:[],this.isIndeterminate=!1},handlecheckedPCAChange(t){let e=t.length;this.checkAll=e===this.checkboxValue.length,this.isIndeterminate=e>0&&e<this.checkboxValue.length},clearChecked(){this.$confirm("此操作将清空您的选项, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.checkedPCA=[]}).catch(()=>{})},initD3(){if(this.checkedPCA.length<2)return void this.$message("请至少选择2个PC！");if(this.checkedPCA.length>10)return void this.$message("最多选择10个PC，请修改您的选项！");r.selectAll(".d3svg")&&r.selectAll(".d3svg").remove();let t=this;var e=this.checkedPCA.length>8?100*this.checkedPCA.length:800,a=this.checkedPCA.length>8?100*this.checkedPCA.length:800,n=80,i=40,c=150,l=20,s=e-n-l,o=a-i-l,d=this.checkedPCA,p=e-n-l,u=a-i-l,h=r.scaleOrdinal(r.schemeCategory20);let m=r.select("body").append("div").style("position","absolute").style("z-index","10").style("visibility","hidden").style("font-size","14px").style("font-weight","bold").text("");var x=r.select(".container").append("svg").attr("class","d3svg").attr("width",s).attr("height",o).style("padding-left",n).style("padding-right",c).style("padding-top",i).style("padding-bottom",l);if(2===this.checkedPCA.length){var f=p,g=u;(P=x.append("g").attr("transform","translate(0,0)")).append("text").attr("x",f/2).attr("y",-20).attr("dy","-0.3em").text(function(){return"PC"+t.checkedPCA[0]}),P.append("text").attr("x",f/2).attr("y",-5).attr("dy","-0.3em").text(function(){return"("+(100*t.percentVariance[t.checkedPCA[0]-1]).toFixed(0)+"%)"}),P.append("text").attr("x",-60).attr("y",g/2).attr("dy","-0.3em").style("text-anchor","start").text(function(){return"PC"+t.checkedPCA[1]}),P.append("text").attr("x",-60).attr("y",g/2+20).attr("dy","-0.3em").style("text-anchor","start").text(function(){return"("+(100*t.percentVariance[t.checkedPCA[1]-1]).toFixed(0)+"%)"});var y=r.scaleLinear().range([g,0]).domain([r.max([t.maxValue[t.checkedPCA[0]-1],t.maxValue[t.checkedPCA[1]-1]])+2,r.min([t.minValue[t.checkedPCA[0]-1],t.minValue[t.checkedPCA[1]-1]])-2]),k=r.axisLeft(y).ticks(3),v=(P.append("g").attr("class","yaxis").attr("transform","translate(0,0)").call(k).style("font-size","14px"),r.scaleLinear().range([0,f]).domain([r.min([t.minValue[t.checkedPCA[0]-1],t.minValue[t.checkedPCA[1]-1]])-2,r.max([t.maxValue[t.checkedPCA[0]-1],t.maxValue[t.checkedPCA[1]-1]])+2])),C=r.axisBottom(v).ticks(3);P.append("g").attr("class","xaxis").attr("transform","translate(0 ,"+g+")").call(C).style("font-size","14px");function A(){return r.axisBottom(v).ticks(3)}function V(){return r.axisLeft(y).ticks(3)}P.append("g").attr("class","grid").attr("transform","translate(0,"+g+")").call(A().tickSize(-g).tickFormat("")),P.append("g").attr("class","grid").call(V().tickSize(-f).tickFormat(""));h=r.scaleOrdinal(r.schemeCategory20);P.append("g").selectAll("circle").data(t.tableValue).enter().append("circle").attr("cx",function(e,a){return v(e.value[t.checkedPCA[0]-1])}).attr("cy",function(e,a){return y(e.value[t.checkedPCA[1]-1])}).attr("r",t.radius).attr("fill",function(e){return h(h(t.nameSampleMap[e.name].condition))}).style("opacity",t.opacity).on("mouseover",(t,e)=>m.style("visibility","visible").text(t.name)).on("mousemove",function(t,e){return m.style("top",event.pageY-10+"px").style("left",event.pageX+10+"px")}).on("mouseout",function(t,e){return m.style("visibility","hidden")})}else{f=p/t.checkedPCA.length,g=u/t.checkedPCA.length;for(let e=0;e<d.length;e++){for(let a=0;a<d.length;a++){var P=x.append("g").attr("transform","translate("+(a*f+0)+","+(e*g+0)+")");y=r.scaleLinear().range([g,0]).domain([r.max([t.maxValue[d[a]-1],t.maxValue[d[e]-1]])+2,r.min([t.minValue[d[a]-1],t.minValue[d[e]-1]])-2]),k=r.axisLeft(y).ticks(d.length>2?0:3),P.append("g").attr("class","yaxis").attr("transform","translate(0,0)").call(k).style("font-size","14px"),v=r.scaleLinear().range([0,f]).domain([r.min([t.minValue[d[a]-1],t.minValue[d[e]-1]])-2,r.max([t.maxValue[d[a]-1],t.maxValue[d[e]-1]])+2]),C=r.axisBottom(v).ticks(d.length>2?0:3),P.append("g").attr("class","xaxis").attr("transform","translate(0 ,"+g+")").call(C).style("font-size","14px");function A(){return r.axisBottom(v).ticks(3)}function V(){return r.axisLeft(y).ticks(3)}P.append("g").attr("class","grid").attr("transform","translate(0,"+g+")").call(A().tickSize(-g).tickFormat("")),P.append("g").attr("class","grid").call(V().tickSize(-f).tickFormat("")),P.append("g").selectAll("circle").data(t.tableValue).enter().append("circle").attr("cx",function(t){return v(t.value[d[a]-1])}).attr("cy",function(t){return y(t.value[d[e]-1])}).attr("r",function(e){return t.radius}).attr("fill",function(e){return h(t.nameSampleMap[e.name].condition)}).style("opacity",t.opacity).on("mouseover",(t,e)=>m.style("visibility","visible").text(t.name)).on("mousemove",function(t,e){return m.style("top",event.pageY-10+"px").style("left",event.pageX+10+"px")}).on("mouseout",function(t,e){return m.style("visibility","hidden")})}x.append("text").attr("x",f/2.5+e*f).attr("y",-15).attr("dy","-0.3em").text(function(){return"PC"+t.checkedPCA[e]}),x.append("text").attr("x",f/2.5+e*f).attr("y",-2).attr("dy","-0.3em").text(function(){return"("+(100*t.percentVariance[t.checkedPCA[e]-1]).toFixed(0)+"%)"}),x.append("text").attr("x",-60).attr("y",g/2+e*g).attr("dy","-0.3em").style("text-anchor","start").text(function(){return"PC"+t.checkedPCA[e]}),x.append("text").attr("x",-60).attr("y",g/2+20+e*g).attr("dy","-0.3em").style("text-anchor","start").text(function(){return"("+(100*t.percentVariance[t.checkedPCA[e]-1]).toFixed(0)+"%)"})}}r.selectAll(".xaxis .domain").remove(),r.selectAll(".yaxis .domain").remove(),x.append("text").attr("x",s+10).attr("y",20).attr("dy","-0.3em").text(function(){return"group"});for(let e=0;e<t.conditionArr.length;e++)x.append("rect").attr("x",s+10).attr("y",25+30*e).attr("width",30).attr("height",30).attr("fill","white").attr("stroke","#999"),x.append("circle").attr("cx",s+10+15).attr("cy",25+30*e+15).attr("r",8).attr("fill",h(t.conditionArr[e])),x.append("text").attr("x",s+10+40).attr("y",50+30*e).attr("dy","-0.3em").text(t.conditionArr[e])}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",{staticStyle:{height:"calc(100% - 62px)","margin-top":"2px"}},[a("el-aside",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.menuShow,expression:"$store.state.menuShow"}],staticStyle:{width:"300px",height:"100%","border-right":"1px solid #e6e6e6"},attrs:{width:"350px;"}},[a("leftMenu",{staticStyle:{"margin-top":"5px"}})],1),t._v(" "),a("el-main",[a("div",{},[a("imgMenuShowComp"),t._v(" "),a("el-breadcrumb",{staticStyle:{margin:"5px 0 50px 0"},attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"report"}}},[t._v("项目 "+t._s(t.$store.state.projectName))]),t._v(" "),a("el-breadcrumb-item",[t._v("PCA 主成分分析")])],1),t._v(" "),a("h2",[t._v("PCA 主成分分析")]),t._v(" "),a("el-checkbox-group",{on:{change:t.handlecheckedPCAChange},model:{value:t.checkedPCA,callback:function(e){t.checkedPCA=e},expression:"checkedPCA"}},t._l(t.checkboxValue,function(e,n){return a("el-checkbox",{directives:[{name:"show",rawName:"v-show",value:t.percentVariance[n]>.01,expression:"percentVariance[index] > 0.01?true:false"}],key:e,staticStyle:{width:"20%"},attrs:{label:e}},[t._v("PC"+t._s(e)+" ( "+t._s((100*t.percentVariance[n]).toFixed(0))+"% )")])})),t._v(" "),a("br"),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.initD3()}}},[t._v("确定")]),t._v(" "),a("el-button",{attrs:{type:"info"},on:{click:function(e){t.clearChecked()}}},[t._v("清空")]),t._v("\n         \n      点的半径："),a("el-input-number",{attrs:{size:"mini",step:1,min:0},on:{change:function(e){t.initD3()}},model:{value:t.radius,callback:function(e){t.radius=e},expression:"radius"}}),t._v("\n         \n      点透明度："),a("el-input-number",{attrs:{size:"mini",step:.1,min:0},on:{change:function(e){t.initD3()}},model:{value:t.opacity,callback:function(e){t.opacity=e},expression:"opacity"}}),t._v(" "),a("div",{staticClass:"container"})],1)])],1)},staticRenderFns:[]};var s=a("VU/8")(c,l,!1,function(t){a("/cFl"),a("uCz3")},"data-v-75c05907",null);e.default=s.exports}});
//# sourceMappingURL=10.449f22cae3bcb1827170.js.map