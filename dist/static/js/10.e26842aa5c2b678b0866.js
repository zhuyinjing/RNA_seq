webpackJsonp([10],{"Cv+O":function(t,e){},Jpf2:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("Oj91"),s=a("f4AQ"),n={data:()=>({rangeShow:!1,showNum:3e3,arr:[],xvalueShow:!0,geneNameShow:!1,xLeft:1,yTop:0,xmin:-3,xmax:3,ymin:0,ymax:12,radius:1.5,width:800,height:600,xLeftOptions:{eventType:"auto",width:350,height:6,dotSize:16,dotHeight:null,dotWidth:null,min:0,max:3},xRightOptions:{eventType:"auto",width:5,height:550,dotSize:16,dotHeight:null,dotWidth:null,min:2,max:4},pvalueArr:[],padjArr:[]}),components:{leftMenu:i.a},mounted(){this.getData()},watch:{$route:"getDataReset"},methods:{getDataReset(){this.xvalueShow=!0,this.geneNameShow=!1,this.showNum=3e3,this.xLeft=1,this.yTop=2,this.xmin=-3,this.xmax=3,this.ymin=0,this.ymax=12,this.width=800,this.height=600,this.radius=1.5,this.getData()},getData(){let t=sessionStorage.getItem("_case"),e=sessionStorage.getItem("_control");this.axios.get("/server/volcano?username="+this.$store.state.username+"&p="+this.$store.state.projectId+"&_case="+t+"&_control="+e+"&gene_num="+this.showNum).then(t=>{if(t.data.length>0){this.pvalueArr=[],this.padjArr=[],t.data=t.data.slice(1);for(let e=0;e<t.data.length;e++){let a=t.data[e];this.pvalueArr.push([a[1]-0,-1*Math.log10(a[2]),a[4]]),this.padjArr.push([a[1]-0,-1*Math.log10(a[3]),a[4]])}!0===this.xvalueShow?this.arr=this.pvalueArr:this.arr=this.padjArr,this.rangeShow=!0,this.initD3(),this.xLeftChange()}else this.$message({message:"暂无数据!",duration:1e3})})},backReport(){this.$router.push({name:"report"})},change(){s.selectAll(".red").attr("class","green")},initD3(){s.selectAll("svg")&&s.selectAll("svg").remove();let t=this,e=this.width,a=this.height,i=30,n=30,r=30,l=30;this.xLeftOptions.max=this.xmax,this.xRightOptions.min=this.ymin,this.xRightOptions.max=this.ymax,this.xLeftOptions.width=this.width/2-40,this.xRightOptions.height=this.height-50;let o=s.select("#canvas").append("svg").attr("id","svg").attr("width",e).attr("height",a),h=s.scaleLinear().domain([this.xmin,this.xmax]).range([0,e-i-n]),c=s.scaleLinear().domain([this.ymin,this.ymax]).range([a-r-l,0]),d=s.select("body").append("div").style("position","absolute").style("z-index","10").style("color","#3497db").style("visibility","hidden").style("font-size","12px").style("font-weight","bold").text(""),x=(o.selectAll("circle").data(t.arr).enter().append("circle").attr("cx",t=>i+h(t[0])).attr("cy",t=>l+c(t[1])).attr("r",t.radius).on("mouseover",function(t,e){return d.style("visibility","visible").text(t[2])}).on("mousemove",function(t,e){return d.style("top",event.pageY-10+"px").style("left",event.pageX+10+"px")}).on("mouseout",function(t,e){return d.style("visibility","hidden")}),s.axisBottom().scale(h)),p=s.axisLeft().scale(c);o.append("g").attr("class","axis").attr("transform","translate("+i+","+(a-l)+")").call(x).append("text").text("Log2FoldChange").attr("fill","#000").attr("transform","translate("+e/2.2+", 28)"),o.append("g").attr("class","axis").attr("transform","translate("+i+","+r+")").call(p).append("text").text("-log10(pvalue)").attr("fill","#000").attr("transform","translate("+i+", -10)"),o.append("line").attr("x1",i+h(t.xLeft)).attr("y1",l+c(0)).attr("x2",i+h(t.xLeft)).attr("y2",l+c(t.ymax)).attr("stroke","#999").style("stroke-dasharray","5"),o.append("line").attr("x1",i+h(-t.xLeft)).attr("y1",l+c(0)).attr("x2",i+h(-t.xLeft)).attr("y2",l+c(t.ymax)).attr("stroke","#999").style("stroke-dasharray","5"),o.append("line").attr("x1",i+h(t.xmin)).attr("y1",l+c(t.yTop)).attr("x2",i+h(t.xmax)).attr("y2",l+c(t.yTop)).attr("stroke","#999").style("stroke-dasharray","5"),!0===t.geneNameShow&&o.selectAll("text").data(t.arr).enter().append("text").filter(e=>e[1]>t.yTop&&Math.abs(e[0])>t.xLeft).text(t=>t[2]).attr("x",t=>i+h(t[0])+5).attr("y",t=>l+c(t[1])).attr("fill","#3497db").style("font-size","6px").style("font-weight","bold"),0===t.xLeft&&0===t.yTop||t.circleColor()},xLeftChange(){let t=this;s.selectAll("circle").classed("green",(e,a)=>e[0]<-t.xLeft&&e[1]>t.yTop).classed("red",(e,a)=>e[0]>t.xLeft&&e[1]>t.yTop);this.initD3()},circleColor(){let t=this;s.selectAll("circle").classed("green",(e,a)=>e[0]<-t.xLeft&&e[1]>t.yTop).classed("red",(e,a)=>e[0]>t.xLeft&&e[1]>t.yTop)},xvaluechange(){!0===this.xvalueShow?(this.arr=this.pvalueArr,this.initD3()):(this.arr=this.padjArr,this.initD3())}}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{},[a("leftMenu",{staticStyle:{float:"left",width:"300px","margin-top":"10px"}}),t._v(" "),a("div",{staticClass:"content"},[a("el-breadcrumb",{staticStyle:{margin:"5px 0 50px 0"},attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"report"}}},[t._v("项目 "+t._s(t.$store.state.projectName))]),t._v(" "),a("el-breadcrumb-item",[t._v("火山图")])],1),t._v(" "),a("h2",[t._v("基因差异表达火山图 "+t._s(t.$route.query._case)+" vs "+t._s(t.$route.query._control)+" ")]),t._v(" "),a("p",[t._v("火山图（Volcano Plot）的横纵坐标分别显示基因差异表达的两个重要指标（ 横坐标为 log2FoldChange，越偏离原点差异倍数越大；纵坐标为 -log10(pvalue)，该值越大，说明差异越显著 ）。通过火山图，可以非常直观地筛选出在两样本间发生显著差异表达的基因。")]),t._v(" "),a("div",{staticClass:"min-width-div"},[a("div",{directives:[{name:"show",rawName:"v-show",value:t.rangeShow,expression:"rangeShow"}],staticClass:"yrange display-inline-block"},[a("el-slider",{style:{marginTop:"26px",marginLeft:"-20px",height:t.xRightOptions.height+"px"},attrs:{step:.1,min:t.xRightOptions.min,max:t.xRightOptions.max,vertical:""},on:{change:function(e){t.xLeftChange()}},model:{value:t.yTop,callback:function(e){t.yTop=e},expression:"yTop"}})],1),t._v(" "),a("div",{staticClass:"display-inline-block vertical-align-top",attrs:{id:"canvas"}}),t._v(" "),a("div",{staticClass:"clear"}),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.rangeShow,expression:"rangeShow"}]},[a("el-slider",{style:{width:t.xLeftOptions.width+"px",marginLeft:t.xLeftOptions.width+50+"px"},attrs:{step:.1,min:t.xLeftOptions.min,max:t.xLeftOptions.max},on:{change:function(e){t.xLeftChange()}},model:{value:t.xLeft,callback:function(e){t.xLeft=e},expression:"xLeft"}})],1),t._v(" "),a("table",{directives:[{name:"show",rawName:"v-show",value:t.rangeShow,expression:"rangeShow"}],staticClass:"gridtable"},[t._m(0),t._v(" "),a("tr",[a("td",[t._v("x轴显示")]),t._v(" "),a("td",[a("el-switch",{staticStyle:{display:"block"},attrs:{"active-color":"#409EFF","inactive-color":"#409EFF","active-text":"pvalue","inactive-text":"padj"},on:{change:t.xvaluechange},model:{value:t.xvalueShow,callback:function(e){t.xvalueShow=e},expression:"xvalueShow"}})],1)]),t._v(" "),a("tr",[a("td",[t._v("是否显示基因名")]),t._v(" "),a("td",[a("el-switch",{staticStyle:{display:"block"},attrs:{"active-color":"#409EFF","inactive-color":"#e4e7ed"},on:{change:t.initD3},model:{value:t.geneNameShow,callback:function(e){t.geneNameShow=e},expression:"geneNameShow"}})],1)]),t._v(" "),a("tr",[a("td",[t._v("显示基因个数")]),t._v(" "),a("td",[a("el-input-number",{attrs:{size:"mini",min:0,label:"描述文字"},on:{change:t.getData},model:{value:t.showNum,callback:function(e){t.showNum=e},expression:"showNum"}})],1)]),t._v(" "),a("tr",[a("td",[t._v("Log2FoldChange")]),t._v(" "),a("td",[a("el-input-number",{attrs:{size:"mini",min:0,step:.1},on:{change:t.xLeftChange},model:{value:t.xLeft,callback:function(e){t.xLeft=e},expression:"xLeft"}})],1)]),t._v(" "),a("tr",[a("td",[t._v("-log10(pvalue)")]),t._v(" "),a("td",[a("el-input-number",{attrs:{size:"mini",min:0,step:.1},on:{change:t.xLeftChange},model:{value:t.yTop,callback:function(e){t.yTop=e},expression:"yTop"}})],1)]),t._v(" "),a("tr",[a("td",[t._v("x轴最小值")]),t._v(" "),a("td",[a("el-input-number",{attrs:{size:"mini"},on:{change:t.initD3},model:{value:t.xmin,callback:function(e){t.xmin=e},expression:"xmin"}})],1)]),t._v(" "),a("tr",[a("td",[t._v("x轴最大值")]),t._v(" "),a("td",[a("el-input-number",{attrs:{size:"mini"},on:{change:t.initD3},model:{value:t.xmax,callback:function(e){t.xmax=e},expression:"xmax"}})],1)]),t._v(" "),a("tr",[a("td",[t._v("y轴最小值")]),t._v(" "),a("td",[a("el-input-number",{attrs:{size:"mini"},on:{change:t.initD3},model:{value:t.ymin,callback:function(e){t.ymin=e},expression:"ymin"}})],1)]),t._v(" "),a("tr",[a("td",[t._v("y轴最大值")]),t._v(" "),a("td",[a("el-input-number",{attrs:{size:"mini"},on:{change:t.initD3},model:{value:t.ymax,callback:function(e){t.ymax=e},expression:"ymax"}})],1)]),t._v(" "),a("tr",[a("td",[t._v("宽")]),t._v(" "),a("td",[a("el-input-number",{attrs:{size:"mini"},on:{change:t.initD3},model:{value:t.width,callback:function(e){t.width=e},expression:"width"}})],1)]),t._v(" "),a("tr",[a("td",[t._v("高")]),t._v(" "),a("td",[a("el-input-number",{attrs:{size:"mini"},on:{change:t.initD3},model:{value:t.height,callback:function(e){t.height=e},expression:"height"}})],1)]),t._v(" "),a("tr",[a("td",[t._v("点的半径")]),t._v(" "),a("td",[a("el-input-number",{attrs:{size:"mini",min:0,step:.1},on:{change:t.initD3},model:{value:t.radius,callback:function(e){t.radius=e},expression:"radius"}})],1)])])])],1),t._v(" "),a("div",{staticClass:"clear"})],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("th",[this._v("参数")]),e("th",[this._v("操作")])])}]};var l=a("VU/8")(n,r,!1,function(t){a("Cv+O"),a("o5wD")},"data-v-1e7b344a",null);e.default=l.exports},o5wD:function(t,e){}});
//# sourceMappingURL=10.e26842aa5c2b678b0866.js.map