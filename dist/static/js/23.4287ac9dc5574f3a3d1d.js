webpackJsonp([23],{h8XU:function(t,e){},rwf8:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("Oj91"),n=a("K0Oa"),i=a("f4AQ"),l={data:()=>({xData:[],yData:[],tableValue:[],href:""}),components:{leftMenu:r.a,imgMenuShowComp:n.a},mounted(){this.axios.get("/server/enrich_bubble_diagram?username="+this.$store.state.username+"&p="+this.$store.state.projectId+"&fileType=KEGG").then(t=>{this.xData=t.data.x,this.yData=t.data.y,this.tableValue=t.data.coordinateList,this.initD3()})},methods:{initD3(){let t=this;var e=400,a=40,r=200,n=80,l=1e3-e-n,o=1e3-a-n,s=i.select("#d3container").append("svg").attr("class","d3bubblesvg").attr("width",1e3+r).attr("height",1e3+n).append("g").attr("transform","translate("+e+","+a+")");let c=t.yData,u=i.scaleBand().rangeRound([o,0]).padding(1).domain(c.map(function(t){return t.y})),p=i.axisLeft(u);s.append("g").attr("class","yaxis").attr("transform","translate(0,0)").call(p).style("font-size","14px").style("cursor","pointer");s.selectAll(".tick text").on("mouseover",function(t,e){i.select(this).style("fill","#409EFF")}).on("mouseout",function(t,e){i.select(this).style("fill","")}).on("click",function(e,a){t.href="https://www.genome.jp/dbget-bin/www_bget?"+t.yData[a].id,setTimeout(()=>{t.$refs.aTag.click()},100)});let d=t.xData,m=i.scaleBand().rangeRound([0,l]).padding(1).domain(d.map(function(t){return t.replace("."," vs ")})),x=i.axisBottom(m);s.append("g").attr("class","xaxis").attr("transform","translate(0 ,"+o+")").call(x).selectAll("text").style("font-size","14px").style("text-anchor","start").attr("transform","rotate(45 -10 10)");i.selectAll(".domain").remove(),s.append("g").attr("class","grid").attr("transform","translate(0,"+o+")").call(i.axisBottom(m).ticks(4).tickSize(-o).tickFormat("")),s.append("g").attr("class","grid").call(i.axisLeft(u).ticks(4).tickSize(-l).tickFormat(""));var f=i.scaleLinear().domain([i.min(t.tableValue,function(t){return Number(t.p_value)}),i.max(t.tableValue,function(t){return Number(t.p_value)})]).range(["red","blue"]),h=i.scaleLinear().domain([i.min(t.tableValue,function(t){return t.gene_ratio}),i.max(t.tableValue,function(t){return t.gene_ratio})]).range([8,16]),v=s.append("g");v.selectAll("circle").data(t.tableValue).enter().append("circle").attr("cx",function(t){return m(t.x.replace("."," vs "))}).attr("cy",function(t){return u(t.y)}).attr("r",function(t){return h(t.gene_ratio)}).attr("fill",function(t){return f(Number(t.p_value))}).on("mouseover",function(t){let e=this;i.select(this),y.attr("x",function(){return m(t.x.replace("."," vs "))}).attr("y",function(){return u(t.y)-1.6*i.select(e).attr("r")-5}).text(function(){return"pvalue:"+Number(t.p_value).toFixed(3)+" , gene_ratio:"+t.gene_ratio.toFixed(3)}).attr("text-anchor","middle")}).on("mouseout",function(){i.select(this),y.text("")});v.append("g");let y=s.append("text").text("").attr("font-size","14px");var b=s.append("defs").append("linearGradient").attr("id","linearColor").attr("x1","0%").attr("y1","100%").attr("x2","0%").attr("y2","0%");b.append("stop").attr("offset","0%").style("stop-color","red"),b.append("stop").attr("offset","100%").style("stop-color","blue"),s.append("rect").attr("x",l+50).attr("y",o/1.5).attr("width",40).attr("height",100).style("fill","url(#"+b.attr("id")+")"),s.append("text").attr("class","valueText").attr("x",l+100).attr("y",o-280).attr("dy","-0.3em").text(function(){return i.max(t.tableValue,function(t){return Number(t.p_value).toFixed(3)})}),s.append("text").attr("class","valueText").attr("x",l+100).attr("y",o-190).attr("dy","-0.3em").text(function(){return i.min(t.tableValue,function(t){return Number(t.p_value).toFixed(3)})}),s.append("text").attr("class","valueText").attr("x",l+50).attr("y",o/1.5-10).attr("dy","-0.3em").text(function(){return"pvalue"}),s.append("rect").attr("x",l+50).attr("y",130).attr("width",40).attr("height",40).attr("fill","white").attr("stroke","#999");s.append("circle").attr("cx",l+50+20).attr("cy",150).attr("r",h(i.min(t.tableValue,function(t){return Number(t.gene_ratio)}))).attr("fill","black"),s.append("text").attr("class","valueText").attr("x",l+50).attr("y",120).attr("dy","-0.3em").text(function(){return"GeneRatio"}),s.append("text").attr("class","valueText").attr("x",l+100).attr("y",160).attr("dy","-0.3em").text(function(){return i.min(t.tableValue,function(t){return Number(t.gene_ratio)}).toFixed(3)});s.append("rect").attr("x",l+50).attr("y",170).attr("width",40).attr("height",40).attr("fill","white").attr("stroke","#999");s.append("circle").attr("cx",l+50+20).attr("cy",190).attr("r",h(i.max(t.tableValue,function(t){return Number(t.gene_ratio)}))).attr("fill","black"),s.append("text").attr("class","valueText").attr("x",l+100).attr("y",200).attr("dy","-0.3em").text(function(){return i.max(t.tableValue,function(t){return Number(t.gene_ratio)}).toFixed(3)}),i.selectAll(".tick").selectAll("line").style("stroke","#cccccc4d")}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",{staticStyle:{height:"calc(100% - 62px)","margin-top":"2px"}},[a("el-aside",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.menuShow,expression:"$store.state.menuShow"}],staticStyle:{width:"300px",height:"100%","border-right":"1px solid #e6e6e6"},attrs:{width:"350px;"}},[a("leftMenu",{staticStyle:{"margin-top":"5px"}})],1),t._v(" "),a("el-main",[a("div",{},[a("imgMenuShowComp"),t._v(" "),a("el-breadcrumb",{staticStyle:{margin:"5px 0 50px 0"},attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"report"}}},[t._v("项目 "+t._s(t.$store.state.projectName))]),t._v(" "),a("el-breadcrumb-item",[t._v("KEGG 气泡图")])],1),t._v(" "),a("h2",[t._v("KEGG 气泡图 ")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-document"},on:{click:function(e){t.$store.commit("d3savePDF","KEGG 富集分析气泡图")}}},[t._v("生成 PDF")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-picture"},on:{click:function(e){t.$store.commit("d3saveSVG","KEGG 富集分析气泡图")}}},[t._v("生成 SVG")]),t._v(" "),a("div",{attrs:{id:"d3container"}}),t._v(" "),a("a",{ref:"aTag",attrs:{href:t.href,target:"_blank"}})],1)])],1)},staticRenderFns:[]};var s=a("VU/8")(l,o,!1,function(t){a("h8XU")},"data-v-dc386d16",null);e.default=s.exports}});
//# sourceMappingURL=23.4287ac9dc5574f3a3d1d.js.map