webpackJsonp([17],{Jpf2:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("Oj91"),s=i("SH1Y"),n=i("K0Oa"),l=i("f4AQ"),o={data:()=>({rangeShow:!1,showNum:3e3,arr:[],xvalueShow:!0,geneNameShow:!1,xLeft:1,yTop:0,xmin:-3,xmax:3,ymin:0,ymax:12,radius:1.8,width:800,height:600,xLeftOptions:{eventType:"auto",width:350,height:6,dotSize:16,dotHeight:null,dotWidth:null,min:0,max:3},xRightOptions:{eventType:"auto",width:5,height:550,dotSize:16,dotHeight:null,dotWidth:null,min:2,max:4},pvalueArr:[],padjArr:[]}),components:{leftMenu:a.a,degComp:s.a,imgMenuShowComp:n.a},mounted(){this.getData()},watch:{$route:"getDataReset"},methods:{getDataReset(){this.xvalueShow=!0,this.geneNameShow=!1,this.showNum=3e3,this.xLeft=1,this.yTop=2,this.xmin=-3,this.xmax=3,this.ymin=0,this.ymax=12,this.width=800,this.height=600,this.radius=1.5,this.getData()},getData(){let t=sessionStorage.getItem("_case"),e=sessionStorage.getItem("_control");this.axios.get("/server/volcano?username="+this.$store.state.username+"&p="+this.$store.state.projectId+"&_case="+t+"&_control="+e+"&gene_num="+this.showNum).then(t=>{if(t.data.length>0){this.pvalueArr=[],this.padjArr=[],t.data=t.data.slice(1);for(let e=0;e<t.data.length;e++){let i=t.data[e];this.pvalueArr.push([i[1]-0,-1*Math.log10(i[2]),i[4]]),this.padjArr.push([i[1]-0,-1*Math.log10(i[3]),i[4]])}!0===this.xvalueShow?this.arr=this.pvalueArr:this.arr=this.padjArr,this.rangeShow=!0,this.initD3(),this.xLeftChange()}else this.$message({message:"暂无数据!",duration:1e3})})},backReport(){this.$router.push({name:"report"})},change(){l.selectAll(".red").attr("class","green")},initD3(){l.selectAll("svg")&&l.selectAll("svg").remove();let t=this,e=this.width,i=this.height,a=30,s=30,n=30,o=30;this.xLeftOptions.max=this.xmax,this.xRightOptions.min=this.ymin,this.xRightOptions.max=this.ymax,this.xLeftOptions.width=this.width/2-40,this.xRightOptions.height=this.height-50;let r=l.select("#d3container").append("svg").attr("id","svg").attr("width",e).attr("height",i),h=l.scaleLinear().domain([this.xmin,this.xmax]).range([0,e-a-s]),c=l.scaleLinear().domain([this.ymin,this.ymax]).range([i-n-o,0]),d=l.select("body").append("div").style("position","absolute").style("z-index","10").style("color","#3497db").style("visibility","hidden").style("font-size","12px").style("font-weight","bold").text(""),p=(r.selectAll("circle").data(t.arr).enter().append("circle").attr("cx",t=>a+h(t[0])).attr("cy",t=>o+c(t[1])).attr("r",t.radius).on("mouseover",function(t,e){return d.style("visibility","visible").text(t[2])}).on("mousemove",function(t,e){return d.style("top",l.event.pageY-10+"px").style("left",l.event.pageX+10+"px")}).on("mouseout",function(t,e){return d.style("visibility","hidden")}),l.axisBottom().scale(h)),x=l.axisLeft().scale(c);r.append("g").attr("class","axis").attr("transform","translate("+a+","+(i-o)+")").call(p).append("text").text("Log2FoldChange").attr("fill","#000").attr("transform","translate("+e/2.2+", 28)"),r.append("g").attr("class","axis").attr("transform","translate("+a+","+n+")").call(x).append("text").text("-log10(pvalue)").attr("fill","#000").attr("transform","translate("+a+", -10)"),r.append("line").attr("x1",a+h(t.xLeft)).attr("y1",o+c(0)).attr("x2",a+h(t.xLeft)).attr("y2",o+c(t.ymax)).attr("stroke","#999").style("stroke-dasharray","5"),r.append("line").attr("x1",a+h(-t.xLeft)).attr("y1",o+c(0)).attr("x2",a+h(-t.xLeft)).attr("y2",o+c(t.ymax)).attr("stroke","#999").style("stroke-dasharray","5"),r.append("line").attr("x1",a+h(t.xmin)).attr("y1",o+c(t.yTop)).attr("x2",a+h(t.xmax)).attr("y2",o+c(t.yTop)).attr("stroke","#999").style("stroke-dasharray","5"),!0===t.geneNameShow&&r.selectAll("text").data(t.arr).enter().append("text").filter(e=>e[1]>t.yTop&&Math.abs(e[0])>t.xLeft).text(t=>t[2]).attr("x",t=>a+h(t[0])+5).attr("y",t=>o+c(t[1])).attr("fill","#3497db").style("font-size","6px").style("font-weight","bold"),0===t.xLeft&&0===t.yTop||t.circleColor(),l.selectAll(".red").style("fill","red"),l.selectAll(".green").style("fill","green")},xLeftChange(){let t=this;l.selectAll("circle").classed("green",(e,i)=>e[0]<-t.xLeft&&e[1]>t.yTop).classed("red",(e,i)=>e[0]>t.xLeft&&e[1]>t.yTop);this.initD3()},circleColor(){let t=this;l.selectAll("circle").classed("green",(e,i)=>e[0]<-t.xLeft&&e[1]>t.yTop).classed("red",(e,i)=>e[0]>t.xLeft&&e[1]>t.yTop)},xvaluechange(){!0===this.xvalueShow?(this.arr=this.pvalueArr,this.initD3()):(this.arr=this.padjArr,this.initD3())}}},r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-container",{staticStyle:{height:"calc(100% - 62px)","margin-top":"2px"}},[i("el-aside",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.menuShow,expression:"$store.state.menuShow"}],staticStyle:{width:"300px",height:"100%","border-right":"1px solid #e6e6e6"},attrs:{width:"350px;"}},[i("leftMenu",{staticStyle:{"margin-top":"5px"}})],1),t._v(" "),i("el-main",[i("imgMenuShowComp"),t._v(" "),i("degComp"),t._v(" "),i("div",{},[i("p",[t._v("火山图（Volcano Plot）的横纵坐标分别显示基因差异表达的两个重要指标（ 横坐标为 log2FoldChange，越偏离原点差异倍数越大；纵坐标为 -log10(pvalue)，该值越大，说明差异越显著 ）。通过火山图，可以非常直观地筛选出在两样本间发生显著差异表达的基因。")]),t._v(" "),i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-picture"},on:{click:function(e){t.$store.commit("d3saveSVG","火山图")}}},[t._v("生成 SVG")]),t._v(" "),i("i",{staticClass:"el-icon-question cursor-pointer",staticStyle:{"font-size":"16px"},on:{click:function(e){t.$store.state.svgDescribeShow=!0}}}),t._v(" "),i("div",[i("div",{directives:[{name:"show",rawName:"v-show",value:t.rangeShow,expression:"rangeShow"}],staticClass:"yrange display-inline-block vertical-align-top"},[i("el-slider",{style:{marginTop:"26px",marginLeft:"-20px",height:t.xRightOptions.height+"px"},attrs:{step:.1,min:t.xRightOptions.min,max:t.xRightOptions.max,vertical:""},on:{change:function(e){t.xLeftChange()}},model:{value:t.yTop,callback:function(e){t.yTop=e},expression:"yTop"}})],1),t._v(" "),i("div",{staticClass:"display-inline-block vertical-align-top",attrs:{id:"d3container"}}),t._v(" "),i("div",{staticClass:"clear"}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.rangeShow,expression:"rangeShow"}]},[i("el-slider",{style:{width:t.xLeftOptions.width+"px",marginLeft:t.xLeftOptions.width+50+"px"},attrs:{step:.1,min:t.xLeftOptions.min,max:t.xLeftOptions.max},on:{change:function(e){t.xLeftChange()}},model:{value:t.xLeft,callback:function(e){t.xLeft=e},expression:"xLeft"}})],1),t._v(" "),i("table",{directives:[{name:"show",rawName:"v-show",value:t.rangeShow,expression:"rangeShow"}],staticClass:"gridtable"},[i("tr",[i("th",[t._v("参数")]),i("th",[t._v("操作")])]),t._v(" "),i("tr",[i("td",[t._v("y轴显示")]),t._v(" "),i("td",[i("el-switch",{staticStyle:{display:"block"},attrs:{"active-color":"#409EFF","inactive-color":"#409EFF","active-text":" -log10(pvalue)","inactive-text":"-log10(padj)"},on:{change:t.xvaluechange},model:{value:t.xvalueShow,callback:function(e){t.xvalueShow=e},expression:"xvalueShow"}})],1)]),t._v(" "),i("tr",[i("td",[t._v("是否显示基因名")]),t._v(" "),i("td",[i("el-switch",{staticStyle:{display:"block"},attrs:{"active-color":"#409EFF","inactive-color":"#e4e7ed"},on:{change:t.initD3},model:{value:t.geneNameShow,callback:function(e){t.geneNameShow=e},expression:"geneNameShow"}})],1)]),t._v(" "),i("tr",[i("td",[t._v("显示基因个数")]),t._v(" "),i("td",[i("el-input-number",{attrs:{size:"mini",min:0,label:"描述文字"},on:{change:t.getData},model:{value:t.showNum,callback:function(e){t.showNum=e},expression:"showNum"}})],1)]),t._v(" "),i("tr",[i("td",[t._v("Log2FoldChange")]),t._v(" "),i("td",[i("el-input-number",{attrs:{size:"mini",min:0,step:.1},on:{change:t.xLeftChange},model:{value:t.xLeft,callback:function(e){t.xLeft=e},expression:"xLeft"}})],1)]),t._v(" "),i("tr",[i("td",[t._v("-log10(pvalue)")]),t._v(" "),i("td",[i("el-input-number",{attrs:{size:"mini",min:0,step:.1},on:{change:t.xLeftChange},model:{value:t.yTop,callback:function(e){t.yTop=e},expression:"yTop"}})],1)]),t._v(" "),i("tr",[i("td",[t._v("x轴最小值")]),t._v(" "),i("td",[i("el-input-number",{attrs:{size:"mini"},on:{change:t.initD3},model:{value:t.xmin,callback:function(e){t.xmin=e},expression:"xmin"}})],1)]),t._v(" "),i("tr",[i("td",[t._v("x轴最大值")]),t._v(" "),i("td",[i("el-input-number",{attrs:{size:"mini"},on:{change:t.initD3},model:{value:t.xmax,callback:function(e){t.xmax=e},expression:"xmax"}})],1)]),t._v(" "),i("tr",[i("td",[t._v("y轴最小值")]),t._v(" "),i("td",[i("el-input-number",{attrs:{size:"mini"},on:{change:t.initD3},model:{value:t.ymin,callback:function(e){t.ymin=e},expression:"ymin"}})],1)]),t._v(" "),i("tr",[i("td",[t._v("y轴最大值")]),t._v(" "),i("td",[i("el-input-number",{attrs:{size:"mini"},on:{change:t.initD3},model:{value:t.ymax,callback:function(e){t.ymax=e},expression:"ymax"}})],1)]),t._v(" "),i("tr",[i("td",[t._v("宽")]),t._v(" "),i("td",[i("el-input-number",{attrs:{size:"mini"},on:{change:t.initD3},model:{value:t.width,callback:function(e){t.width=e},expression:"width"}})],1)]),t._v(" "),i("tr",[i("td",[t._v("高")]),t._v(" "),i("td",[i("el-input-number",{attrs:{size:"mini"},on:{change:t.initD3},model:{value:t.height,callback:function(e){t.height=e},expression:"height"}})],1)]),t._v(" "),i("tr",[i("td",[t._v("点的半径")]),t._v(" "),i("td",[i("el-input-number",{attrs:{size:"mini",min:0,step:.1},on:{change:t.initD3},model:{value:t.radius,callback:function(e){t.radius=e},expression:"radius"}})],1)])])])],1)],1)],1)},staticRenderFns:[]};var h=i("VU/8")(o,r,!1,function(t){i("sKw/"),i("eWTt")},"data-v-1e912bad",null);e.default=h.exports},eWTt:function(t,e){},"sKw/":function(t,e){}});
//# sourceMappingURL=17.430c6c3e5161a5da6a73.js.map