{"version":3,"sources":["webpack:///src/components/heatmapsvg.vue","webpack:///./src/components/heatmapsvg.vue?ab0b","webpack:///./src/components/heatmapsvg.vue"],"names":["heatmapsvg","data","arr","temp","value","sortValue","idShow","visible","height","components","leftMenu","[object Object]","this","$store","state","heatmapJson","heatmap_json_string","JSON","parse","self","k","nodes","node","preOrder","distance","push","objects","i","features","length","setTimeout","d3heatmap","methods","d3","remove","yData","xData","feature_names","margin","width","gridSize","Math","floor","sort","a","b","min","ceil","middle","max","linear","domain","range","darker","svg","append","attr","heatMap","selectAll","enter","text","d","style","parseInt","transition","duration","$router","name","components_heatmapsvg","render","_vm","_h","$createElement","_c","_self","staticStyle","float","margin-top","_v","staticClass","attrs","separator","to","path","_s","projectName","_case","_control","active-text","inactive-text","on","change","idShowChange","model","callback","$$v","expression","id","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/15.eeba9c616cdc1fd53b80.js","sourcesContent":["<template>\n  <div class=\"\">\n    <leftMenu style=\"float:left;width:300px;margin-top:10px;\"></leftMenu>\n\n    <div class=\"content\">\n      <el-breadcrumb separator=\"/\" style=\"margin:5px 0 50px 0\">\n        <el-breadcrumb-item :to=\"{ path: 'report' }\">项目{{$store.state.projectName}}</el-breadcrumb-item>\n        <el-breadcrumb-item :to=\"{ path: 'report_deg' }\">差异表达基因</el-breadcrumb-item>\n        <el-breadcrumb-item :to=\"{ path: 'heatmapsvg_input' }\">绘制蛋白蛋白相互作用图</el-breadcrumb-item>\n        <el-breadcrumb-item>Heat Map(svg)</el-breadcrumb-item>\n      </el-breadcrumb>\n\n      <h2>基因Heat Map(svg) {{$store.state._case}} vs {{$store.state._control}} </h2>\n\n\n      <div class=\"icon-func-div\">\n        <span class=\"font-size-12\">ID显示</span>\n        <el-switch\n          v-model=\"idShow\"\n          active-text=\"\"\n          inactive-text=\"\"\n          @change=\"idShowChange\"\n          >\n        </el-switch>\n      </div>\n\n      <div id=\"chart\"></div>\n\n      </div>\n  </div>\n\n</template>\n\n<script>\nimport leftMenu from './leftMenu.vue'\n\nimport * as d3 from 'd3'\n\nimport Highcharts from 'highcharts/highstock';\nexport default {\n  data () {\n    return {\n      arr: [],\n      temp: [],\n      value: [],\n      sortValue: [],\n      idShow: false,\n      visible: 'hidden',\n      height: 5,\n    }\n  },\n  components: {\n    leftMenu\n  },\n  mounted () {\n    this.$store.state.heatmapJson.heatmap_json_string = JSON.parse(this.$store.state.heatmapJson.heatmap_json_string)\n\n    let self = this\n    for (let k in this.$store.state.heatmapJson.heatmap_json_string.data.nodes) {\n      let node = this.$store.state.heatmapJson.heatmap_json_string.data.nodes[k]\n      if (('parent' in node) === false) {\n        preOrder(node)\n      }\n    }\n    function preOrder(node){\n       if(node.distance === 0){\n         self.temp.push(node.objects[0]);  // y 轴的gene名称\n         for(let i = 0;i < node.features.length;i++) {\n           self.value.push(node.features[i])   // 每一行的值\n           self.sortValue.push(node.features[i])  // 用来排序的数组\n         }\n       } else {\n         preOrder(self.$store.state.heatmapJson.heatmap_json_string.data.nodes[node['left_child']]);\n         preOrder(self.$store.state.heatmapJson.heatmap_json_string.data.nodes[node['right_child']]);\n       }\n     }\n\n    setTimeout(() => {\n      this.d3heatmap()\n    }, 500)\n  },\n  methods: {\n    idShowChange () {\n      if (this.idShow === true) {\n        this.height = 9\n        this.visible = 'visible'\n      } else {\n        this.height = 5\n        this.visible = 'hidden'\n      }\n      this.d3heatmap()\n    },\n    d3heatmap () {\n      let hassvg = d3.selectAll('.d3svg')\n      if (hassvg) {\n        d3.selectAll('.d3svg').remove()\n      }\n      let self = this\n      let yData = self.temp\n      let xData = this.$store.state.heatmapJson.heatmap_json_string.data.feature_names\n\n      var array_data = [];\n      var margin = { top: 50, right: 0, bottom: 100, left: 100 },\n          width = 800 - margin.left - margin.right,        // 所有格子区域的宽度，即Heatmap的宽度\n          height = self.height * yData.length ,\n          gridSize = Math.floor(width / xData.length)     // 求地板，即去掉小数部分，width分成24份\n\n              function sortNumber (a, b) {\n                return a - b\n              }\n              self.sortValue.sort(sortNumber)   //  排序后的数组\n              let min = self.sortValue[Math.ceil(0.1 * self.sortValue.length)]\n              let middle = self.sortValue[Math.ceil(self.sortValue.length/2)]\n              let max = self.sortValue[self.sortValue.length - Math.ceil(0.1 * self.sortValue.length) - 1]\n\n              var linear = d3.scaleLinear()\n              \t\t\t\t.domain([min, middle, max])\n              \t\t\t\t.range([(d3.rgb(255,0,0)).darker(0.7), (d3.rgb(19,3,3)).darker(1), (d3.rgb(0,255,0)).darker(1)]);\n\n              // 设置chart，svg\n              var svg = d3.select(\"#chart\").append(\"svg\") // 选择“chart”（就是div），加入一个svg，设置属性跟div一样大\n                  .attr(\"width\", width + margin.left + margin.right)\n                  .attr(\"height\", height + margin.top + margin.bottom)\n                  .attr(\"class\", \"d3svg\")\n                  .append(\"g\")    // 在svg内加入一个g（group组），并设置元素g的显示位置\n                  .attr(\"transform\", \"translate(\" + margin.left + \",\" + margin.top + \")\")\n\n              var timeLabels = svg.selectAll(\".testLabel\")\n                  .data(xData)\n                  .enter().append(\"text\")\n                  .text(function(d) { return d; })\n                  .attr(\"x\", function(d, i) { return i * gridSize; })\n                  .attr(\"y\", 0)\n                  .attr(\"class\", 'xText')\n                  .style(\"text-anchor\", \"middle\")\n                  .style(\"font-size\", \"9px\")\n                  .style(\"font-family\", \"Consolas, Monaco, monospace\")\n                  .attr(\"transform\", \"translate(\" + gridSize / 2 + \", -6)\")\n\n             var dayLabels = svg.selectAll(\".nameLabel\")\n                 .data(yData)\n                 .enter()    // 为data中每一项创建一个\".dayLabel\"\n                 .append(\"text\")    // 为days中每一项创建一的\".dayLabel\"添加文本，下面全是设置文本的属性\n                 .text(function (d) { return d; })\n                 .attr(\"x\", 0)\n                 .attr(\"y\", function (d, i) { return i * 9; })\n                 .style(\"text-anchor\", \"end\")\n                 .style(\"font-size\", \"9px\")\n                 .style(\"font-family\", \"Consolas, Monaco, monospace\")\n                 .attr(\"transform\", \"translate(-6,\" + \"9)\")\n                 .attr('class', 'ySum')\n                 .style('visibility', self.visible)\n\n              var heatMap = svg.selectAll(\".score\")\n                  .data(self.value)\n                  .enter()\n                  .append(\"rect\")\n                  .attr(\"x\", function(d, i){ return (i % 12)*gridSize;})\n                  .attr(\"y\", function(d, i){ return parseInt(i / 12) * self.height;})\n                  .attr(\"width\", gridSize)\n                  .attr(\"height\", self.height)\n                  .style(\"fill\", \"#FFFFFF\");\n              // duration(1000) 在1000ns也就是1s内将格子图上色\n              heatMap.transition().duration(500)\n                  .style(\"fill\", function(d) { return linear(d) });\n              // 鼠标停留显示value\n              heatMap.append(\"title\").text(function(d) { return d; });\n    },\n    backHeatmapsvgInput () {\n      this.$router.push({'name': 'heatmapsvg_input'})\n    },\n  }\n}\n</script>\n\n<style scoped=\"true\">\n.content {\n  float:left;\n  width: 60%;\n  padding: 0 20px;\n  margin: 19px auto;\n}\n.cursor-pointer {\n  cursor: pointer;\n}\n.icon-func-div {\n  margin-top: 10px;\n}\n.font-size-12 {\n  font-size: 12px;\n}\n.margin-top-200 {\n  margin-top: 200px;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/heatmapsvg.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{},[_c('leftMenu',{staticStyle:{\"float\":\"left\",\"width\":\"300px\",\"margin-top\":\"10px\"}}),_vm._v(\" \"),_c('div',{staticClass:\"content\"},[_c('el-breadcrumb',{staticStyle:{\"margin\":\"5px 0 50px 0\"},attrs:{\"separator\":\"/\"}},[_c('el-breadcrumb-item',{attrs:{\"to\":{ path: 'report' }}},[_vm._v(\"项目\"+_vm._s(_vm.$store.state.projectName))]),_vm._v(\" \"),_c('el-breadcrumb-item',{attrs:{\"to\":{ path: 'report_deg' }}},[_vm._v(\"差异表达基因\")]),_vm._v(\" \"),_c('el-breadcrumb-item',{attrs:{\"to\":{ path: 'heatmapsvg_input' }}},[_vm._v(\"绘制蛋白蛋白相互作用图\")]),_vm._v(\" \"),_c('el-breadcrumb-item',[_vm._v(\"Heat Map(svg)\")])],1),_vm._v(\" \"),_c('h2',[_vm._v(\"基因Heat Map(svg) \"+_vm._s(_vm.$store.state._case)+\" vs \"+_vm._s(_vm.$store.state._control)+\" \")]),_vm._v(\" \"),_c('div',{staticClass:\"icon-func-div\"},[_c('span',{staticClass:\"font-size-12\"},[_vm._v(\"ID显示\")]),_vm._v(\" \"),_c('el-switch',{attrs:{\"active-text\":\"\",\"inactive-text\":\"\"},on:{\"change\":_vm.idShowChange},model:{value:(_vm.idShow),callback:function ($$v) {_vm.idShow=$$v},expression:\"idShow\"}})],1),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"chart\"}})],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-7b52e61c\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/heatmapsvg.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-7b52e61c\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./heatmapsvg.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./heatmapsvg.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./heatmapsvg.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-7b52e61c\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./heatmapsvg.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-7b52e61c\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/heatmapsvg.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}