{"version":3,"sources":["webpack:///src/components/ASprofilePercent.vue","webpack:///./src/components/ASprofilePercent.vue?4080","webpack:///./src/components/ASprofilePercent.vue"],"names":["ASprofilePercent","data","eventsArr","eventsArrReverse","samplesArr","components","leftMenu","imgMenuShowComp","[object Object]","this","getValue","methods","axios","get","$store","state","username","projectId","then","res","message_type","ASProfileInfo","asName","sampleName","i","length","push","asEventPercentMap","Array","from","reverse","initD3","$message","error","margin","svg","d3","append","attr","tooltip","style","text","x","domain","rangeRound","padding","y","color","offset","call","selectAll","tickFormat","d","sum","sum2","index","sample","enter","bandwidth","on","event","pageY","pageX","legend","components_ASprofilePercent","render","_vm","_h","$createElement","_c","_self","staticStyle","height","margin-top","directives","name","rawName","value","expression","width","border-right","attrs","_v","separator","to","path","_s","projectName","id","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"static/js/26.78906f4ff6bbc2254204.js","sourcesContent":["<template>\n<el-container style=\"height:calc(100% - 62px);margin-top:2px\">\n  <el-aside v-show=\"$store.state.menuShow\" width=\"350px;\" style=\"width:300px;height:100%;border-right:1px solid #e6e6e6\">\n    <leftMenu style=\"margin-top:5px\"></leftMenu>\n  </el-aside>\n  <el-main>\n    <div class=\"\">\n      <imgMenuShowComp></imgMenuShowComp>\n\n      <el-breadcrumb separator=\"/\" style=\"margin:5px 0 50px 0\">\n        <el-breadcrumb-item :to=\"{ path: 'report' }\">项目 {{$store.state.projectName}}</el-breadcrumb-item>\n        <el-breadcrumb-item>可变剪切事件百分比统计</el-breadcrumb-item>\n      </el-breadcrumb>\n\n      <h2>可变剪切事件百分比统计</h2>\n\n      <div id=\"canvas\"></div>\n\n    </div>\n  </el-main>\n</el-container>\n</template>\n\n<script>\nimport leftMenu from './leftMenu.vue'\nimport imgMenuShowComp from './imgMenuShowComp.vue'\nimport * as d3 from 'd3'\n\nexport default {\n  data() {\n    return {\n      eventsArr: [],\n      eventsArrReverse: [],\n      samplesArr: [],\n      data: [],\n    }\n  },\n  components: {\n    leftMenu,\n    imgMenuShowComp\n  },\n  mounted() {\n    this.getValue()\n  },\n  methods: {\n    getValue() {\n      this.axios.get('/server/as_profile_info?username=' + this.$store.state.username + '&p=' + this.$store.state.projectId).then((res) => {\n        if (res.data.message_type === 'success') {\n          this.eventsArr = res.data.ASProfileInfo.asName\n          this.samplesArr = res.data.ASProfileInfo.sampleName\n          for(let i = 0;i < this.eventsArr.length;i++) {\n            this.data.push(res.data.ASProfileInfo.asEventPercentMap[this.eventsArr[i]])\n          }\n          this.eventsArrReverse = Array.from(this.eventsArr).reverse()\n          this.initD3()\n        } else {\n          this.$message.error('请求错误!')\n        }\n      })\n    },\n    initD3() {\n      let margin = {\n        left: 50,\n        right: 30,\n        top: 30,\n        bottom: 80\n      }\n\n      let width = 900\n      let height = 600\n\n      let svg = d3.select('#canvas')\n        .append('svg')\n        .attr('id', 'svg')\n        .attr('width', 1000)\n        .attr('height', height)\n      let tooltip = d3.select('body')\n      \t.append('div')\n      \t.style('position', 'absolute')\n        .style('z-index', '10')\n        .style('visibility', 'hidden')\n        .style('font-size', '14px')\n      \t.style('font-weight', 'bold')\n      \t.text('')\n      var x = d3.scaleBand()\n        .domain(this.samplesArr)\n        .rangeRound([margin.left, width - margin.right])\n        .padding(0.3)\n\n      var y = d3.scaleLinear()\n        .domain([0, 100])\n        .rangeRound([height - margin.bottom, margin.top])\n\n      var color = d3.scaleOrdinal(d3.schemeCategory20)\n\n      var stack = d3.stack()\n        .offset(d3.stackOffsetExpand);\n\n      svg.append(\"g\")\n        .attr(\"transform\", \"translate(0,\" + y(0) + \")\")\n        .call(d3.axisBottom(x))\n        .selectAll(\"text\")\n        .style(\"text-anchor\", \"start\")\n        .attr(\"transform\", \"rotate(45 -10 10)\");\n\n      svg.append(\"g\")\n        .attr(\"transform\", \"translate(\" + margin.left + \",0)\")\n        .call(d3.axisLeft(y).tickFormat(d =>  d + \"%\" ))\n      for (let i = 0;i < this.samplesArr.length;i++) {\n        let sum = 0\n        let sum2 = 0\n        let index = i\n        let sample = this.samplesArr[i]\n        svg.selectAll(\".rect\")\n          .data(this.data)\n          .enter().append(\"rect\")\n          .attr(\"x\", (d) => {\n            return x(sample);\n          })\n          .attr(\"y\", (d, i) => {\n            sum = sum + d[index]\n            return y(sum)\n          })\n          .attr(\"height\", (d, i) => {\n            sum2 = sum2 + d[index]\n            if (i === 0) {\n              return y(0) - y(d[index])\n            } else {\n              return y(sum2-d[index]) - y(sum2)\n            }\n          })\n          .attr(\"width\", x.bandwidth())\n          .attr(\"fill\", (d,i) => {\n            return color(i)\n          })\n          .on('mouseover', (d, i) => {\n            return tooltip.style('visibility', 'visible').text(this.eventsArr[i] + ' ' + d[index] + '%')\n          })\n          .on('mousemove', function (d, i) {\n            return tooltip.style('top', (event.pageY-10)+'px').style('left',(event.pageX+10)+'px')\n          })\n          .on('mouseout', function (d, i) {\n            return tooltip.style('visibility', 'hidden')\n          })\n      }\n    //  图例\n    let legend = svg.append(\"g\")\n      .attr(\"transform\", \"translate(\" + (width - 30) + \",\"+ margin.top +\")\")\n    legend.selectAll(\"rect\")\n      .data(this.eventsArrReverse)   // 为了和图的颜色从上到下一样\n      .enter().append(\"rect\")\n      .attr(\"x\",(d,i)=>{\n        return 0\n      })\n      .attr(\"y\",(d,i)=>{\n        return 15 * i + 5 * i   // 每个 rect 间隔为5\n      })\n      .attr(\"width\",15)\n      .attr(\"height\",15)\n      .attr(\"fill\",(d,i) => {\n        return color(this.eventsArr.length - 1 - i)\n      })\n    legend.selectAll(\"text\")\n      .data(this.eventsArrReverse)\n      .enter().append(\"text\")\n      .attr(\"x\",(d,i)=>{\n        return 20\n      })\n      .attr(\"y\",(d,i)=>{\n        return 15 * i + 5 * i + 12\n      })\n      .text((d) => {\n        return d\n      })\n\n\n    },\n  }\n}\n</script>\n\n<style scoped=\"true\">\n.content {\n  float: left;\n  width: calc(100% - 350px);\n  padding: 0 20px;\n  margin: 19px auto;\n}\n\n.cursor-pointer {\n  cursor: pointer;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/ASprofilePercent.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('el-container',{staticStyle:{\"height\":\"calc(100% - 62px)\",\"margin-top\":\"2px\"}},[_c('el-aside',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.$store.state.menuShow),expression:\"$store.state.menuShow\"}],staticStyle:{\"width\":\"300px\",\"height\":\"100%\",\"border-right\":\"1px solid #e6e6e6\"},attrs:{\"width\":\"350px;\"}},[_c('leftMenu',{staticStyle:{\"margin-top\":\"5px\"}})],1),_vm._v(\" \"),_c('el-main',[_c('div',{},[_c('imgMenuShowComp'),_vm._v(\" \"),_c('el-breadcrumb',{staticStyle:{\"margin\":\"5px 0 50px 0\"},attrs:{\"separator\":\"/\"}},[_c('el-breadcrumb-item',{attrs:{\"to\":{ path: 'report' }}},[_vm._v(\"项目 \"+_vm._s(_vm.$store.state.projectName))]),_vm._v(\" \"),_c('el-breadcrumb-item',[_vm._v(\"可变剪切事件百分比统计\")])],1),_vm._v(\" \"),_c('h2',[_vm._v(\"可变剪切事件百分比统计\")]),_vm._v(\" \"),_c('div',{attrs:{\"id\":\"canvas\"}})],1)])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-1cbfa532\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/ASprofilePercent.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-1cbfa532\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./ASprofilePercent.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./ASprofilePercent.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./ASprofilePercent.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-1cbfa532\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./ASprofilePercent.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-1cbfa532\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/ASprofilePercent.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}