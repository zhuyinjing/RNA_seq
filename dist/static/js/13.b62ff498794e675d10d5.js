webpackJsonp([13],{BEro:function(t,e){},mCze:function(t,e){},xDHS:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("Oj91"),r=a("K0Oa"),c=a("f4AQ"),i={data:()=>({checkboxValue:[],checkAll:!1,checkedPCA:[],isIndeterminate:!1,tableValue:[],conditionArr:[],maxValue:[],minValue:[],nameSampleMap:{},percentVariance:[]}),components:{leftMenu:n.a,imgMenuShowComp:r.a},created(){this.getValue()},mounted(){},methods:{getValue(){this.axios.get("/server/pca4gene?username="+this.$store.state.username+"&p="+this.$store.state.projectId).then(t=>{this.maxValue=t.data.maxValue,this.minValue=t.data.minValue,this.percentVariance=t.data.pca4GeneExprMatrix.percentVariance,this.nameSampleMap=t.data.experimentDesign.nameSampleMap;for(let e=0;e<t.data.pca4GeneExprMatrix.percentVariance.length;e++)this.checkboxValue.push(e+1);this.checkedPCA=[this.checkboxValue[0],this.checkboxValue[1]];for(let e in t.data.experimentDesign.conditionNumMap)this.conditionArr.push(e);for(let e in t.data.pca4GeneExprMatrix.sampleCoordMap){let a={name:e,value:t.data.pca4GeneExprMatrix.sampleCoordMap[e]};this.tableValue.push(a)}this.initD3()})},handleCheckAllChange(t){this.checkedPCA=t?this.checkboxValue:[],this.isIndeterminate=!1},handlecheckedPCAChange(t){let e=t.length;this.checkAll=e===this.checkboxValue.length,this.isIndeterminate=e>0&&e<this.checkboxValue.length},clearChecked(){this.$confirm("此操作将清空您的选项, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.checkedPCA=[]}).catch(()=>{})},initD3(){if(this.checkedPCA.length<2)return void this.$message("请至少选择2个PC！");if(this.checkedPCA.length>10)return void this.$message("最多选择10个PC，请修改您的选项！");c.selectAll(".d3svg")&&c.selectAll(".d3svg").remove();let t=this;var e=this.checkedPCA.length>8?100*this.checkedPCA.length:800,a=this.checkedPCA.length>8?100*this.checkedPCA.length:800,n=80,r=40,i=150,l=20,s=e-n-l,o=a-r-l,d=this.checkedPCA,h=e-n-l,u=a-r-l,p=c.scaleOrdinal(c.schemeCategory20),m=c.select(".container").append("svg").attr("class","d3svg").attr("width",s).attr("height",o).style("padding-left",n).style("padding-right",i).style("padding-top",r).style("padding-bottom",l);if(2===this.checkedPCA.length){var x=h,f=u;(V=m.append("g").attr("transform","translate(0,0)")).append("text").attr("x",x/2).attr("y",-20).attr("dy","-0.3em").text(function(){return"PC"+t.checkedPCA[0]}),V.append("text").attr("x",x/2).attr("y",-5).attr("dy","-0.3em").text(function(){return"("+(100*t.percentVariance[t.checkedPCA[0]-1]).toFixed(0)+"%)"}),V.append("text").attr("x",-60).attr("y",f/2).attr("dy","-0.3em").style("text-anchor","start").text(function(){return"PC"+t.checkedPCA[1]}),V.append("text").attr("x",-60).attr("y",f/2+20).attr("dy","-0.3em").style("text-anchor","start").text(function(){return"("+(100*t.percentVariance[t.checkedPCA[1]-1]).toFixed(0)+"%)"});var g=c.scaleLinear().range([f,0]).domain([c.max([t.maxValue[t.checkedPCA[0]-1],t.maxValue[t.checkedPCA[1]-1]])+2,c.min([t.minValue[t.checkedPCA[0]-1],t.minValue[t.checkedPCA[1]-1]])-2]),k=c.axisLeft(g).ticks(3),C=(V.append("g").attr("class","yaxis").attr("transform","translate(0,0)").call(k).style("font-size","14px"),c.scaleLinear().range([0,x]).domain([c.min([t.minValue[t.checkedPCA[0]-1],t.minValue[t.checkedPCA[1]-1]])-2,c.max([t.maxValue[t.checkedPCA[0]-1],t.maxValue[t.checkedPCA[1]-1]])+2])),A=c.axisBottom(C).ticks(3);V.append("g").attr("class","xaxis").attr("transform","translate(0 ,"+f+")").call(A).style("font-size","14px");function y(){return c.axisBottom(C).ticks(3)}function P(){return c.axisLeft(g).ticks(3)}V.append("g").attr("class","grid").attr("transform","translate(0,"+f+")").call(y().tickSize(-f).tickFormat("")),V.append("g").attr("class","grid").call(P().tickSize(-x).tickFormat(""));p=c.scaleOrdinal(c.schemeCategory20);(v=V.append("g")).selectAll("circle").data(t.tableValue).enter().append("circle").attr("cx",function(e,a){return C(e.value[t.checkedPCA[0]-1])}).attr("cy",function(e,a){return g(e.value[t.checkedPCA[1]-1])}).attr("r",function(t){return 6}).attr("fill",function(e){return p(p(t.nameSampleMap[e.name].condition))}).on("mouseover",function(a){c.select(this),e.attr("x",function(){return C(a.value[t.checkedPCA[0]-1])}).attr("y",function(){return g(a.value[t.checkedPCA[1]-1])-1.6*c.select(this).attr("r")-20}).text(function(){return a.name}).attr("text-anchor","middle")}).on("mouseout",function(){c.select(this),e.text("")});v.append("g");let e=V.append("text").text("").attr("font-size","14px")}else{x=h/t.checkedPCA.length,f=u/t.checkedPCA.length;for(let e=0;e<d.length;e++){for(let a=0;a<d.length;a++){var v,V=m.append("g").attr("transform","translate("+(a*x+0)+","+(e*f+0)+")");g=c.scaleLinear().range([f,0]).domain([c.max([t.maxValue[d[a]-1],t.maxValue[d[e]-1]])+2,c.min([t.minValue[d[a]-1],t.minValue[d[e]-1]])-2]),k=c.axisLeft(g).ticks(d.length>2?0:3),V.append("g").attr("class","yaxis").attr("transform","translate(0,0)").call(k).style("font-size","14px"),C=c.scaleLinear().range([0,x]).domain([c.min([t.minValue[d[a]-1],t.minValue[d[e]-1]])-2,c.max([t.maxValue[d[a]-1],t.maxValue[d[e]-1]])+2]),A=c.axisBottom(C).ticks(d.length>2?0:3),V.append("g").attr("class","xaxis").attr("transform","translate(0 ,"+f+")").call(A).style("font-size","14px");function y(){return c.axisBottom(C).ticks(3)}function P(){return c.axisLeft(g).ticks(3)}V.append("g").attr("class","grid").attr("transform","translate(0,"+f+")").call(y().tickSize(-f).tickFormat("")),V.append("g").attr("class","grid").call(P().tickSize(-x).tickFormat("")),(v=V.append("g")).selectAll("circle").data(t.tableValue).enter().append("circle").attr("cx",function(t){return C(t.value[d[a]-1])}).attr("cy",function(t){return g(t.value[d[e]-1])}).attr("r",function(e){return t.checkedPCA.length>6?2:10/(d.length-1)}).attr("fill",function(e){return p(t.nameSampleMap[e.name].condition)}).on("mouseover",function(t){c.select(this),n.attr("x",function(){return C(0)}).attr("y",function(){return g(0)}).text(function(){return t.name}).attr("text-anchor","middle")}).on("mouseout",function(){c.select(this),n.text("")});v.append("g");let n=V.append("text").text("").attr("font-size","14px")}m.append("text").attr("x",x/2.5+e*x).attr("y",-15).attr("dy","-0.3em").text(function(){return"PC"+t.checkedPCA[e]}),m.append("text").attr("x",x/2.5+e*x).attr("y",-2).attr("dy","-0.3em").text(function(){return"("+(100*t.percentVariance[t.checkedPCA[e]-1]).toFixed(0)+"%)"}),m.append("text").attr("x",-60).attr("y",f/2+e*f).attr("dy","-0.3em").style("text-anchor","start").text(function(){return"PC"+t.checkedPCA[e]}),m.append("text").attr("x",-60).attr("y",f/2+20+e*f).attr("dy","-0.3em").style("text-anchor","start").text(function(){return"("+(100*t.percentVariance[t.checkedPCA[e]-1]).toFixed(0)+"%)"})}}c.selectAll(".xaxis .domain").remove(),c.selectAll(".yaxis .domain").remove(),m.append("text").attr("x",s+10).attr("y",120).attr("dy","-0.3em").text(function(){return"group"});for(let e=0;e<t.conditionArr.length;e++)m.append("rect").attr("x",s+10).attr("y",130+30*e).attr("width",30).attr("height",30).attr("fill","white").attr("stroke","#999"),m.append("circle").attr("cx",s+10+15).attr("cy",130+30*e+15).attr("r",8).attr("fill",p(t.conditionArr[e])),m.append("text").attr("x",s+10+40).attr("y",155+30*e).attr("dy","-0.3em").text(t.conditionArr[e])}}},l={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-container",{staticStyle:{height:"calc(100% - 62px)","margin-top":"2px"}},[a("el-aside",{directives:[{name:"show",rawName:"v-show",value:t.$store.state.menuShow,expression:"$store.state.menuShow"}],staticStyle:{width:"300px",height:"100%","border-right":"1px solid #e6e6e6"},attrs:{width:"350px;"}},[a("leftMenu",{staticStyle:{"margin-top":"5px"}})],1),t._v(" "),a("el-main",[a("div",{},[a("imgMenuShowComp"),t._v(" "),a("el-breadcrumb",{staticStyle:{margin:"5px 0 50px 0"},attrs:{separator:"/"}},[a("el-breadcrumb-item",{attrs:{to:{path:"report"}}},[t._v("项目 "+t._s(t.$store.state.projectName))]),t._v(" "),a("el-breadcrumb-item",[t._v("PCA 主成分分析")])],1),t._v(" "),a("h2",[t._v("PCA 主成分分析")]),t._v(" "),a("el-checkbox-group",{on:{change:t.handlecheckedPCAChange},model:{value:t.checkedPCA,callback:function(e){t.checkedPCA=e},expression:"checkedPCA"}},t._l(t.checkboxValue,function(e){return a("el-checkbox",{key:e,staticStyle:{width:"20%"},attrs:{label:e}},[t._v("PC"+t._s(e))])})),t._v(" "),a("br"),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.initD3()}}},[t._v("确定")]),t._v(" "),a("el-button",{attrs:{type:"info"},on:{click:function(e){t.clearChecked()}}},[t._v("清空")]),t._v(" "),a("div",{staticClass:"container"})],1)])],1)},staticRenderFns:[]};var s=a("VU/8")(i,l,!1,function(t){a("BEro"),a("mCze")},"data-v-1b0817dc",null);e.default=s.exports}});
//# sourceMappingURL=13.b62ff498794e675d10d5.js.map